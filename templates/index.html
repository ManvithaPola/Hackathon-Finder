<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hackathon Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, #fef7f0 0%, #f4e4c7 100%);
            min-height: 100vh;
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .floating-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes pulse-glow {
            from { box-shadow: 0 4px 20px rgba(139, 69, 19, 0.3); }
            to { box-shadow: 0 8px 30px rgba(139, 69, 19, 0.6); }
        }
        
        .slide-in-left {
            animation: slideInLeft 0.8s ease-out;
        }
        
        @keyframes slideInLeft {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
            opacity: 0;
            transform: translateY(30px);
        }
        
        @keyframes fadeInUp {
            to { opacity: 1; transform: translateY(0); }
        }
        
        .stagger-animation {
            animation-delay: var(--delay);
        }
        
        .gradient-border {
            position: relative;
            background: linear-gradient(45deg, #8B4513, #D2B48C, #8B4513);
            background-size: 300% 300%;
            animation: gradient-shift 3s ease infinite;
        }
        
        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .hover-lift {
            transition: all 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(139, 69, 19, 0.3);
        }
        
        .neon-text {
            text-shadow: 0 0 10px rgba(139, 69, 19, 0.5);
        }
        
        .data-row {
            transition: all 0.3s ease;
        }
        
        .data-row:hover {
            background: linear-gradient(90deg, rgba(139, 69, 19, 0.1), rgba(210, 180, 140, 0.2));
            transform: scale(1.02);
        }
    </style>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brown: {
                            50: '#fef7f0',
                            100: '#fef2e2',
                            200: '#fde2c9',
                            300: '#fbcba4',
                            400: '#f7a86e',
                            500: '#f38947',
                            600: '#e4692b',
                            700: '#bd4f21',
                            800: '#973f20',
                            900: '#7a351e',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body>
    <!-- Navbar -->
    <nav class="bg-gradient-to-r from-brown-800 to-brown-700 shadow-2xl sticky top-0 z-50 backdrop-blur-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-lg flex items-center justify-center pulse-glow">
                        <i class="fas fa-code text-white text-lg"></i>
                    </div>
                    <h1 class="text-white text-2xl font-bold neon-text">Hackathon Dashboard</h1>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="#" class="text-white hover:text-brown-200 transition-colors duration-300 font-medium">
                        <i class="fas fa-home mr-2"></i>Home
                    </a>
                    <a href="#" class="text-white hover:text-brown-200 transition-colors duration-300 font-medium">
                        <i class="fas fa-info-circle mr-2"></i>About
                    </a>
                    <a href="#" class="text-white hover:text-brown-200 transition-colors duration-300 font-medium">
                        <i class="fas fa-envelope mr-2"></i>Contact
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Sidebar Filters -->
            <div class="lg:col-span-1">
                <div class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-2xl p-6 sticky top-24 slide-in-left">
                    <div class="gradient-border rounded-xl p-0.5 mb-6">
                        <div class="bg-white rounded-xl p-4">
                            <h3 class="text-xl font-bold text-brown-800 mb-4 flex items-center">
                                <i class="fas fa-filter mr-3 text-brown-600"></i>
                                Filters
                            </h3>
                        </div>
                    </div>

                    <!-- Source Filter -->
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-brown-800 mb-3">
                            <i class="fas fa-globe mr-2"></i>Source
                        </label>
                        <div class="space-y-2">
                            {% for s in ['Devpost','MLH','Hackathon.com','Eventbrite','AngelHack'] %}
                            <label class="flex items-center group cursor-pointer">
                                <input type="checkbox" class="source-filter w-4 h-4 text-brown-600 bg-brown-50 border-brown-300 rounded focus:ring-brown-500 transition-all duration-300" value="{{s}}" checked>
                                <span class="ml-3 text-sm text-brown-700 group-hover:text-brown-900 transition-colors duration-300">{{s}}</span>
                            </label>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Mode Filter -->
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-brown-800 mb-3">
                            <i class="fas fa-laptop mr-2"></i>Mode
                        </label>
                        <div class="space-y-2">
                            {% for m in ['Online','Offline','Unknown'] %}
                            <label class="flex items-center group cursor-pointer">
                                <input type="checkbox" class="mode-filter w-4 h-4 text-brown-600 bg-brown-50 border-brown-300 rounded focus:ring-brown-500 transition-all duration-300" value="{{m}}" checked>
                                <span class="ml-3 text-sm text-brown-700 group-hover:text-brown-900 transition-colors duration-300">{{m}}</span>
                            </label>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Year Filter -->
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-brown-800 mb-3">
                            <i class="fas fa-calendar-alt mr-2"></i>Year
                        </label>
                        <select id="year-filter" class="w-full p-3 border border-brown-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent transition-all duration-300 bg-white">
                            <option value="All" selected>All Years</option>
                            {% for y in hackathons|map(attribute='Date')|map('slice',0,4)|unique %}
                            <option value="{{y}}">{{y}}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Month Filter -->
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-brown-800 mb-3">
                            <i class="fas fa-calendar mr-2"></i>Month
                        </label>
                        <select id="month-filter" class="w-full p-3 border border-brown-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent transition-all duration-300 bg-white">
                            <option value="All" selected>All Months</option>
                            {% for month in hackathons|map(attribute='Date')|map('slice',5,7)|unique %}
                            <option value="{{month}}">{{month}}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Search Filter -->
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-brown-800 mb-3">
                            <i class="fas fa-search mr-2"></i>Search
                        </label>
                        <div class="relative">
                            <input type="text" id="search-box" class="w-full p-3 pl-10 border border-brown-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent transition-all duration-300" placeholder="Search hackathons...">
                            <i class="fas fa-search absolute left-3 top-3.5 text-brown-400"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="lg:col-span-3">
                <!-- Summary Cards -->
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8" id="summary-cards">
                    <!-- Cards will be populated by JavaScript -->
                </div>

                <!-- Charts -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 hover-lift fade-in-up stagger-animation" style="--delay: 0.2s;">
                        <h4 class="text-lg font-semibold text-brown-800 mb-4 flex items-center">
                            <i class="fas fa-chart-bar mr-2 text-brown-600"></i>
                            By Source
                        </h4>
                        <canvas id="sourceChart" class="max-h-64"></canvas>
                    </div>
                    <div class="bg-white/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 hover-lift fade-in-up stagger-animation" style="--delay: 0.4s;">
                        <h4 class="text-lg font-semibold text-brown-800 mb-4 flex items-center">
                            <i class="fas fa-chart-line mr-2 text-brown-600"></i>
                            By Month
                        </h4>
                        <canvas id="monthChart" class="max-h-64"></canvas>
                    </div>
                    <div class="bg-white/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 hover-lift fade-in-up stagger-animation" style="--delay: 0.6s;">
                        <h4 class="text-lg font-semibold text-brown-800 mb-4 flex items-center">
                            <i class="fas fa-chart-pie mr-2 text-brown-600"></i>
                            By Mode
                        </h4>
                        <canvas id="modeChart" class="max-h-64"></canvas>
                    </div>
                </div>

                <!-- Hackathon Table -->
                <div class="bg-white/90 backdrop-blur-lg rounded-2xl shadow-2xl overflow-hidden fade-in-up stagger-animation" style="--delay: 0.8s;">
                    <div class="gradient-border rounded-t-2xl p-0.5">
                        <div class="bg-brown-800 rounded-t-2xl px-6 py-4">
                            <h3 class="text-xl font-bold text-white flex items-center">
                                <i class="fas fa-table mr-3"></i>
                                Hackathons Directory
                            </h3>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full" id="hackathonTable">
                            <thead class="bg-brown-700 text-white">
                                <tr>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">
                                        <i class="fas fa-trophy mr-2"></i>Title
                                    </th>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">
                                        <i class="fas fa-calendar mr-2"></i>Date
                                    </th>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">
                                        <i class="fas fa-map-marker-alt mr-2"></i>Location
                                    </th>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">
                                        <i class="fas fa-desktop mr-2"></i>Mode
                                    </th>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">
                                        <i class="fas fa-source mr-2"></i>Source
                                    </th>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">
                                        <i class="fas fa-external-link-alt mr-2"></i>Link
                                    </th>
                                    <th class="px-6 py-4 text-left text-sm font-semibold">
                                        <i class="fas fa-clock mr-2"></i>Countdown
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-brown-100" id="table-body">
                                {% for h in hackathons %}
                                <tr class="data-row" data-source="{{h.Source}}" data-mode="{{h.Mode or 'Unknown'}}" data-year="{{h.Date[:4]}}" data-month="{{h.Date[5:7]}}">
                                    <td class="px-6 py-4 text-sm font-medium text-brown-900">{{ h.Title }}</td>
                                    <td class="px-6 py-4 text-sm text-brown-700">{{ h.Date }}</td>
                                    <td class="px-6 py-4 text-sm text-brown-700">
                                        <span class="inline-flex items-center">
                                            <i class="fas fa-map-pin mr-1 text-brown-500"></i>
                                            {{ h.Location or 'Unknown' }}
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 text-sm">
                                        {% if h.Mode == 'Online' %}
                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                <i class="fas fa-wifi mr-1"></i>Online
                                            </span>
                                        {% elif h.Mode == 'Offline' %}
                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-brown-100 text-brown-800">
                                                <i class="fas fa-building mr-1"></i>Offline
                                            </span>
                                        {% else %}
                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                                                <i class="fas fa-question mr-1"></i>Unknown
                                            </span>
                                        {% endif %}
                                    </td>
                                    <td class="px-6 py-4 text-sm">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            {{ h.Source }}
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 text-sm">
                                        <a href="{{ h.Link }}" target="_blank" class="inline-flex items-center text-brown-600 hover:text-brown-900 font-medium hover:underline transition-colors duration-300">
                                            <i class="fas fa-external-link-alt mr-1"></i>
                                            Open
                                        </a>
                                    </td>
                                    <td class="px-6 py-4 text-sm countdown-cell font-semibold">
                                        <!-- Will be populated by JavaScript -->
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Pagination -->
                    <div class="bg-brown-50 px-6 py-4 border-t border-brown-200 flex items-center justify-between">
                        <div class="flex items-center text-sm text-brown-700">
                            <span>Showing <span id="showing-count">0</span> hackathons</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button id="prev-btn" class="px-3 py-1 rounded-lg bg-brown-600 text-white hover:bg-brown-700 transition-colors duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <span id="page-info" class="px-3 py-1 text-sm font-medium text-brown-700">Page 1</span>
                            <button id="next-btn" class="px-3 py-1 rounded-lg bg-brown-600 text-white hover:bg-brown-700 transition-colors duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-brown-100 to-brown-200 mt-16 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="flex items-center justify-center space-x-2 text-brown-800 mb-4">
                <i class="fas fa-clock"></i>
                <span>Last Updated: {{ hackathons|map(attribute='ScrapedAt')|max if hackathons else 'N/A' }}</span>
            </div>
            <div class="flex items-center justify-center space-x-2 text-brown-600">
                <i class="fas fa-rocket"></i>
                <span>Powered by Hackathon Finder</span>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let allRows = [];
        let filteredRows = [];
        let currentPage = 1;
        const rowsPerPage = 10;
        let sourceChart, monthChart, modeChart;

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeData();
            setupEventListeners();
            updateAll();
        });

        function initializeData() {
            const tbody = document.getElementById('table-body');
            allRows = Array.from(tbody.querySelectorAll('tr'));
            filteredRows = [...allRows];
        }

        function setupEventListeners() {
            // Filter event listeners
            document.querySelectorAll('.source-filter, .mode-filter').forEach(checkbox => {
                checkbox.addEventListener('change', updateAll);
            });

            document.getElementById('year-filter').addEventListener('change', updateAll);
            document.getElementById('month-filter').addEventListener('change', updateAll);
            document.getElementById('search-box').addEventListener('input', debounce(updateAll, 300));

            // Pagination
            document.getElementById('prev-btn').addEventListener('click', () => changePage(-1));
            document.getElementById('next-btn').addEventListener('click', () => changePage(1));
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function updateAll() {
            filterData();
            updateSummaryCards();
            updateCharts();
            updateCountdown();
            updateTable();
        }

        function filterData() {
            const selectedSources = Array.from(document.querySelectorAll('.source-filter:checked')).map(cb => cb.value);
            const selectedModes = Array.from(document.querySelectorAll('.mode-filter:checked')).map(cb => cb.value);
            const selectedYear = document.getElementById('year-filter').value;
            const selectedMonth = document.getElementById('month-filter').value;
            const searchText = document.getElementById('search-box').value.toLowerCase();

            filteredRows = allRows.filter(row => {
                const source = row.dataset.source;
                const mode = row.dataset.mode;
                const year = row.dataset.year;
                const month = row.dataset.month;
                const title = row.cells[0].textContent.toLowerCase();

                return selectedSources.includes(source) &&
                       selectedModes.includes(mode) &&
                       (selectedYear === 'All' || year === selectedYear) &&
                       (selectedMonth === 'All' || month === selectedMonth) &&
                       title.includes(searchText);
            });

            currentPage = 1; // Reset to first page when filtering
        }

        function updateSummaryCards() {
            const total = filteredRows.length;
            const sourceCount = {};
            const modeCount = {};
            const dates = [];

            filteredRows.forEach(row => {
                const source = row.dataset.source;
                const mode = row.dataset.mode;
                const dateStr = row.cells[1].textContent;
                const date = new Date(dateStr);

                sourceCount[source] = (sourceCount[source] || 0) + 1;
                modeCount[mode] = (modeCount[mode] || 0) + 1;
                
                if (!isNaN(date.getTime())) {
                    dates.push(date);
                }
            });

            const today = new Date();
            const futureDates = dates.filter(d => d >= today).sort((a, b) => a - b);
            const pastDates = dates.filter(d => d < today).sort((a, b) => b - a);
            
            const earliest = dates.length ? new Date(Math.min(...dates)) : null;
            const latest = dates.length ? new Date(Math.max(...dates)) : null;
            const nextHackathon = futureDates.length ? futureDates[0] : null;
            const nextHackathonDays = nextHackathon ? Math.ceil((nextHackathon - today) / (1000 * 60 * 60 * 24)) : null;

            const cardsData = [
                {
                    title: 'Total',
                    value: total,
                    icon: 'fa-trophy',
                    color: 'from-blue-500 to-blue-600'
                },
                {
                    title: 'Sources',
                    value: Object.keys(sourceCount).length,
                    icon: 'fa-globe',
                    color: 'from-green-500 to-green-600'
                },
                {
                    title: 'Modes',
                    value: Object.keys(modeCount).length,
                    icon: 'fa-desktop',
                    color: 'from-purple-500 to-purple-600'
                },
                {
                    title: 'Earliest',
                    value: earliest ? earliest.toLocaleDateString() : 'N/A',
                    icon: 'fa-calendar-alt',
                    color: 'from-indigo-500 to-indigo-600'
                },
                {
                    title: 'Latest',
                    value: latest ? latest.toLocaleDateString() : 'N/A',
                    icon: 'fa-calendar-check',
                    color: 'from-pink-500 to-pink-600'
                },
                {
                    title: 'Next In',
                    value: nextHackathonDays !== null ? `${nextHackathonDays} days` : 'N/A',
                    icon: 'fa-clock',
                    color: 'from-orange-500 to-orange-600'
                }
            ];

            const cardsContainer = document.getElementById('summary-cards');
            cardsContainer.innerHTML = cardsData.map((card, index) => `
                <div class="bg-gradient-to-br ${card.color} rounded-2xl shadow-xl p-6 text-white hover-lift floating-animation fade-in-up stagger-animation" style="--delay: ${index * 0.1}s; animation-delay: ${index * 2}s;">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm opacity-90 font-medium">${card.title}</p>
                            <p class="text-2xl font-bold mt-1">${card.value}</p>
                        </div>
                        <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                            <i class="fas ${card.icon} text-xl"></i>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function updateCharts() {
            const sourceData = {};
            const monthData = {};
            const modeData = {};

            filteredRows.forEach(row => {
                const source = row.dataset.source;
                const mode = row.dataset.mode;
                const month = row.dataset.month;

                sourceData[source] = (sourceData[source] || 0) + 1;
                modeData[mode] = (modeData[mode] || 0) + 1;
                monthData[month] = (monthData[month] || 0) + 1;
            });

            // Chart colors
            const brownColors = ['#8B4513', '#A0522D', '#CD853F', '#D2B48C', '#DEB887'];
            const modeColors = ['#22C55E', '#8B4513', '#6B7280'];

            // Source Chart
            if (sourceChart) sourceChart.destroy();
            const sourceCtx = document.getElementById('sourceChart').getContext('2d');
            sourceChart = new Chart(sourceCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(sourceData),
                    datasets: [{
                        label: 'Hackathons',
                        data: Object.values(sourceData),
                        backgroundColor: brownColors.slice(0, Object.keys(sourceData).length),
                        borderRadius: 8,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });

            // Month Chart
            if (monthChart) monthChart.destroy();
            const monthCtx = document.getElementById('monthChart').getContext('2d');
            monthChart = new Chart(monthCtx, {
                type: 'line',
                data: {
                    labels: Object.keys(monthData),
                    datasets: [{
                        label: 'Hackathons',
                        data: Object.values(monthData),
                        borderColor: '#8B4513',
                        backgroundColor: 'rgba(139, 69, 19, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#8B4513',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });

            // Mode Chart
            if (modeChart) modeChart.destroy();
            const modeCtx = document.getElementById('modeChart').getContext('2d');
            modeChart = new Chart(modeCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(modeData),
                    datasets: [{
                        data: Object.values(modeData),
                        backgroundColor: modeColors.slice(0, Object.keys(modeData).length),
                        borderWidth: 0,
                        hoverBorderWidth: 3,
                        hoverBorderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    size: 12,
                                    weight: '500'
                                }
                            }
                        }
                    },
                    cutout: '60%'
                }
            });
        }

        function updateCountdown() {
            const today = new Date();
            
            filteredRows.forEach(row => {
                const dateStr = row.cells[1].textContent;
                const hackDate = new Date(dateStr);
                const countdownCell = row.querySelector('.countdown-cell');
                
                if (isNaN(hackDate.getTime())) {
                    countdownCell.innerHTML = '<span class="text-gray-500">N/A</span>';
                    return;
                }
                
                const diffTime = hackDate - today;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                if (diffDays < 0) {
                    countdownCell.innerHTML = '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"><i class="fas fa-history mr-1"></i>Past</span>';
                } else if (diffDays === 0) {
                    countdownCell.innerHTML = '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800 animate-pulse"><i class="fas fa-fire mr-1"></i>Today</span>';
                } else if (diffDays <= 7) {
                    countdownCell.innerHTML = `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 animate-pulse"><i class="fas fa-exclamation mr-1"></i>${diffDays} days</span>`;
                } else if (diffDays <= 30) {
                    countdownCell.innerHTML = `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"><i class="fas fa-calendar-day mr-1"></i>${diffDays} days</span>`;
                } else {
                    countdownCell.innerHTML = `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"><i class="fas fa-calendar-plus mr-1"></i>${diffDays} days</span>`;
                }
            });
        }

        function updateTable() {
            const startIndex = (currentPage - 1) * rowsPerPage;
            const endIndex = startIndex + rowsPerPage;
            const paginatedRows = filteredRows.slice(startIndex, endIndex);
            
            // Hide all rows
            allRows.forEach(row => row.style.display = 'none');
            
            // Show paginated rows with stagger animation
            paginatedRows.forEach((row, index) => {
                row.style.display = '';
                row.style.animation = `fadeInUp 0.6s ease-out forwards`;
                row.style.animationDelay = `${index * 0.05}s`;
                row.style.opacity = '0';
                row.style.transform = 'translateY(20px)';
            });

            // Update pagination info
            const totalPages = Math.ceil(filteredRows.length / rowsPerPage);
            document.getElementById('showing-count').textContent = filteredRows.length;
            document.getElementById('page-info').textContent = `Page ${currentPage} of ${totalPages}`;
            
            // Update pagination buttons
            document.getElementById('prev-btn').disabled = currentPage <= 1;
            document.getElementById('next-btn').disabled = currentPage >= totalPages;
        }

        function changePage(direction) {
            const totalPages = Math.ceil(filteredRows.length / rowsPerPage);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                updateTable();
            }
        }

        // Auto-update countdown every minute
        setInterval(() => {
            if (filteredRows.length > 0) {
                updateCountdown();
                updateSummaryCards();
            }
        }, 60000);

        // Add loading animation
        window.addEventListener('load', function() {
            const elements = document.querySelectorAll('.fade-in-up');
            elements.forEach((el, index) => {
                setTimeout(() => {
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });

        // Add smooth scroll behavior
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add search highlight functionality
        function highlightSearchTerm(text, term) {
            if (!term) return text;
            const regex = new RegExp(`(${term})`, 'gi');
            return text.replace(regex, '<mark class="bg-yellow-200 px-1 rounded">$1</mark>');
        }

        // Enhanced search with highlighting
        document.getElementById('search-box').addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            
            setTimeout(() => {
                filteredRows.forEach(row => {
                    const titleCell = row.cells[0];
                    const originalText = titleCell.getAttribute('data-original') || titleCell.textContent;
                    
                    if (!titleCell.getAttribute('data-original')) {
                        titleCell.setAttribute('data-original', originalText);
                    }
                    
                    if (searchTerm) {
                        titleCell.innerHTML = highlightSearchTerm(originalText, searchTerm);
                    } else {
                        titleCell.textContent = originalText;
                    }
                });
            }, 50);
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + F to focus search
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                e.preventDefault();
                document.getElementById('search-box').focus();
            }
            
            // Arrow keys for pagination
            if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'SELECT') {
                if (e.key === 'ArrowLeft') {
                    changePage(-1);
                } else if (e.key === 'ArrowRight') {
                    changePage(1);
                }
            }
        });

        // Add tooltips for interactive elements
        function addTooltips() {
            const tooltipElements = document.querySelectorAll('[data-tooltip]');
            tooltipElements.forEach(el => {
                el.addEventListener('mouseenter', function() {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'absolute bg-gray-800 text-white px-2 py-1 rounded text-sm z-50 pointer-events-none';
                    tooltip.textContent = this.getAttribute('data-tooltip');
                    tooltip.style.bottom = '100%';
                    tooltip.style.left = '50%';
                    tooltip.style.transform = 'translateX(-50%)';
                    this.style.position = 'relative';
                    this.appendChild(tooltip);
                });
                
                el.addEventListener('mouseleave', function() {
                    const tooltip = this.querySelector('.absolute.bg-gray-800');
                    if (tooltip) tooltip.remove();
                });
            });
        }

        // Initialize tooltips
        addTooltips();

        // Add export functionality
        function exportToCSV() {
            const headers = ['Title', 'Date', 'Location', 'Mode', 'Source', 'Link'];
            const csvContent = [
                headers.join(','),
                ...filteredRows.map(row => {
                    return Array.from(row.cells).slice(0, 6).map(cell => {
                        let content = cell.textContent.trim();
                        if (cell.querySelector('a')) {
                            content = cell.querySelector('a').href;
                        }
                        return `"${content.replace(/"/g, '""')}"`;
                    }).join(',');
                })
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `hackathons_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Add export button to the table header
        setTimeout(() => {
            const tableHeader = document.querySelector('.gradient-border .bg-brown-800');
            if (tableHeader) {
                const exportBtn = document.createElement('button');
                exportBtn.innerHTML = '<i class="fas fa-download mr-2"></i>Export CSV';
                exportBtn.className = 'float-right bg-brown-600 hover:bg-brown-500 text-white px-4 py-2 rounded-lg transition-colors duration-300 text-sm';
                exportBtn.onclick = exportToCSV;
                tableHeader.appendChild(exportBtn);
            }
        }, 100);

        // Add refresh button
        function refreshData() {
            // Add loading animation
            const refreshBtn = document.querySelector('[data-refresh]');
            if (refreshBtn) {
                refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Refreshing...';
                refreshBtn.disabled = true;
                
                setTimeout(() => {
                    location.reload();
                }, 1000);
            }
        }

        // Add stats animation on scroll
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-pulse');
                }
            });
        });

        document.querySelectorAll('.floating-animation').forEach(el => {
            observer.observe(el);
        });

        // Add mobile menu toggle
        const mobileMenuBtn = document.createElement('button');
        mobileMenuBtn.className = 'md:hidden text-white p-2';
        mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
        
        mobileMenuBtn.addEventListener('click', function() {
            const navLinks = document.querySelector('.hidden.md\\:flex');
            if (navLinks) {
                navLinks.classList.toggle('hidden');
                navLinks.classList.toggle('flex');
                navLinks.classList.toggle('flex-col');
                navLinks.classList.toggle('absolute');
                navLinks.classList.toggle('top-16');
                navLinks.classList.toggle('left-0');
                navLinks.classList.toggle('w-full');
                navLinks.classList.toggle('bg-brown-800');
                navLinks.classList.toggle('p-4');
            }
        });

        // Add the mobile menu button to navbar
        setTimeout(() => {
            const navbar = document.querySelector('.flex.justify-between.items-center');
            if (navbar) {
                navbar.appendChild(mobileMenuBtn);
            }
        }, 100);
    </script>
</body>
</html>